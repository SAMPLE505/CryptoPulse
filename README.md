# üìò CryptoPulse

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è:
- üßë‚Äçüíª –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- üìà –ü–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç
- üìã –ü–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å –ø–æ–º–æ—â—å—é Poetry

–°–æ–∑–¥–∞–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é venv:

```bash
python -m venv venv
```
–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç [Poetry](https://python-poetry.org/) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ:

```bash
pip install poetry
```

–ó–∞—Ç–µ–º —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
poetry install
```

---

### 2. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤ —á–µ—Ä–µ–∑ Docker Compose

–î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã PostgreSQL –∏ Redis. –û–Ω–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö —Å –ø–æ–º–æ—â—å—é `docker-compose.yml`.

```bash
docker-compose up -d
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```bash
uvicorn app.main:app --reload
```

---

### 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

```
# –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
PYTHONPATH = .

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
SECRET_KEY = "YOUR SECRET KEY"
ALGORITHM = "HS256"
ACCESS_TOKEN_TTL_MINUTES = 30
REFRESH_TOKEN_TTL_DAYS = 30

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DATABASE_URL = "postgresql://test_user:test_password@localhost:5433/test_db"

# Redis
REDIS_HOST = "localhost"
REDIS_DB = 0
REDIS_PORT = 6380

# –ö–ª—é—á API CoinMarketCap
API_KEY = "YOUR CoinMarketCapKey"

# –í—Ä–µ–º—è –∂–∏–∑–Ω–∏ –¥–∞–Ω–Ω—ã—Ö –æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–µ –≤ Redis
CRYPTO_PRICE_TTL_SECONDS = 60
CRYPTO_LIST_TTL_MINUTES = 60
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```bash
docker-compose -f docker-compose.test.yml up -d
```

> –≠—Ç–æ –ø–æ–¥–Ω–∏–º–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã PostgreSQL –∏ Redis, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤.

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤:

```bash
pytest
```

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### POST `/auth/register`

–†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

#### Request:
```json
{
  "email": "user@example.com",
  "password": "yourpassword"
}
```

#### Response:
```json
{
  "message": "User successfully registered",
  "user": {
    "id": 1,
    "email": "user@example.com"
  }
}
```

---

### POST `/auth/login`

–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç access-—Ç–æ–∫–µ–Ω. –¢–∞–∫–∂–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç refresh-—Ç–æ–∫–µ–Ω –≤ `HttpOnly`-cookie.

#### Request:
```json
{
  "email": "user@example.com",
  "password": "yourpassword"
}
```

#### Response:
```json
{
  "access": "jwt_access_token",
  "token_type": "bearer",
  "expires_in": 900
}
```

> `refresh_token` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ cookie –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è access-—Ç–æ–∫–µ–Ω–∞.

---

## üí∞ –ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞

### GET `/crypto/price?symbol=BTC`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É —É–∫–∞–∑–∞–Ω–Ω–æ–π –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã –ø–æ —Å–∏–º–≤–æ–ª—É.

#### Query Parameters:
- `symbol` ‚Äî —Ç–∏–∫–µ—Ä –º–æ–Ω–µ—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `BTC`, `ETH`, `USDT`)

#### Response:
```json
{
  "symbol": "BTC",
  "price": 67000.00
}
```

#### –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏:
- `404 Not Found`: –ú–æ–Ω–µ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- `504 Gateway Timeout`: CoinMarketCap API –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –≤–æ–≤—Ä–µ–º—è
- `502 Bad Gateway`: –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ CoinMarketCap API
- `500 Internal Server Error`: –ù–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞

---

### GET `/crypto/list`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç.

#### Response:
```json
{
  "data": [
    {
      "symbol": "BTC",
      "name": "Bitcoin"
    },
    {
      "symbol": "ETH",
      "name": "Ethereum"
    }
  ]
}
```

#### –í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏:
- `504 Gateway Timeout`: CoinMarketCap API –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –≤–æ–≤—Ä–µ–º—è
- `502 Bad Gateway`: –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ CoinMarketCap API
- `500 Internal Server Error`: –ù–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞

---

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **FastAPI** ‚Äî backend-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- **SQLAlchemy** ‚Äî ORM
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —á–µ—Ä–µ–∑ `docker-compose.yml`)
- **Redis** ‚Äî —Ö—Ä–∞–Ω–µ–Ω–∏–µ refresh-—Ç–æ–∫–µ–Ω–æ–≤ (–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —á–µ—Ä–µ–∑ `docker-compose.yml`)
- **Poetry** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º
- **JWT** ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- **httpx** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ HTTP-–∑–∞–ø—Ä–æ—Å—ã
- **CoinMarketCap API** ‚Äî –¥–∞–Ω–Ω—ã–µ –ø–æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞–º
- **Docker / Docker Compose** ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
app/
‚îú‚îÄ‚îÄ core/              # –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –∫–æ–Ω—Ñ–∏–≥–∏
‚îú‚îÄ‚îÄ models/            # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ schemas/           # Pydantic-—Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ services/          # –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å –∫—Ä–∏–ø—Ç–æ–π, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Å—Ç–æ—Ä–æ–Ω–Ω–µ–º–∏ –∑–∞–¥–∞—á–∞–º–∏
‚îú‚îÄ‚îÄ api/               # –†–æ—É—Ç–µ—Ä—ã FastAPI
‚îú‚îÄ‚îÄ database.py        # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îú‚îÄ‚îÄ exceptions.py      # –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
‚îî‚îÄ‚îÄ main.py            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

---

## üì¶ TODO

- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞ –≤–∞–ª—é—Ç —Å –ø–æ–º–æ—â—å—é –ø–æ–¥–ø–∏—Å–æ–∫
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ access-—Ç–æ–∫–µ–Ω–∞ –ø–æ refresh-—Ç–æ–∫–µ–Ω—É
- –ó–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π
- –¢–µ—Å—Ç—ã –¥–ª—è Redis –∏ —Ç–æ–∫–µ–Ω–æ–≤
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Swagger (`/docs`)
